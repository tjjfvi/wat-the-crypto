import { assertEquals } from "https://deno.land/std@0.163.0/testing/asserts.ts"
import { memBuf, wasm } from "./sr25519.ts"

const state = new BigUint64Array(memBuf.buffer, 0, 25)

wasm.keccak_f1600(wasm.free_adr.value)

assertEquals(
  state,
  new BigUint64Array([
    17376452488221285863n,
    9571781953733019530n,
    15391093639620504046n,
    13624874521033984333n,
    10027350355371872343n,
    18417369716475457492n,
    10448040663659726788n,
    10113917136857017974n,
    12479658147685402012n,
    3500241080921619556n,
    16959053435453822517n,
    12224711289652453635n,
    9342009439668884831n,
    4879704952849025062n,
    140226327413610143n,
    424854978622500449n,
    7259519967065370866n,
    7004910057750291985n,
    13293599522548616907n,
    10105770293752443592n,
    10668034807192757780n,
    1747952066141424100n,
    1654286879329379778n,
    8500057116360352059n,
    16929593379567477321n,
  ]),
)

wasm.keccak_f1600(0)

assertEquals(
  state,
  new BigUint64Array([
    3268651591693945660n,
    7652509465582220653n,
    665843430262795116n,
    9953194536449200276n,
    5736547547768942934n,
    17967033347517840184n,
    9617223347116289805n,
    18083344793841701111n,
    2241559954380719961n,
    16500850453531636773n,
    7552081062576154785n,
    16062764016099891023n,
    3730174026076631541n,
    16142682291168730073n,
    9005134303344136805n,
    18254296170158835523n,
    10943093107769035584n,
    5254247195150641012n,
    16409086168290275388n,
    10493424989303096041n,
    10380288247186775419n,
    2317839531386326248n,
    6571880257221836214n,
    6962369734508286041n,
    2364509455356247900n,
  ]),
)
